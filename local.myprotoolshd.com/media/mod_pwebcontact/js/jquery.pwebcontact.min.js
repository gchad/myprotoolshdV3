
/*!
* @version 3.2.21
* @package PWebContact
* @copyright © 2014 Perfect Web sp. z o.o., All rights reserved. http://www.perfect-web.co
* @license GNU General Public License http://www.gnu.org/licenses/gpl-3.0.html
* @author Piotr Moćko
*
* jQuery 1.8+
*/
var pwebBoxes=pwebBoxes||[];!function(t){pwebContact=function(t){this.init(t)},pwebContact.prototype=function(){var o={};return{constructor:pwebContact,defaults:{id:"",selector:"#pwebcontact",selectorClass:".pwebcontact",debug:!1,basePath:"",baseUrl:"",ajaxUrl:"",reloadToken:!1,bootstrap:2,openAuto:!1,openDelay:0,maxAutoOpen:0,closeAuto:!1,closeDelay:0,closeOther:!0,reset:1,redirectURL:"",redirectDelay:3,layout:"slidebox",position:"left",offsetPosition:"top",tooltips:3,msgScroll:!0,msgPosition:"after",msgCloseDelay:10,rulesModal:!1,togglerNameOpen:"",togglerNameClose:"",slideWidth:0,slideDuration:400,slideTransition:"swing",accordionDuration:500,accordionEaseIn:"easeInBack",accordionEaseOut:"easeOutBounce",modalBackdrop:!0,modalClose:!0,modalStyle:"default",modalEffect:"square",modalEffectDuration:400,modalEaseIn:"easeInCubic",modalEaseOut:"easeOutCubic",cookieLifetime:30,cookiePath:"/",cookieDomain:"",onLoad:function(){},onOpen:function(){},onClose:function(){},onComplete:function(){},onError:function(){},uploadAcceptFileTypes:/(\.|\/)(gif|jpe?g|png|docx?|odt|txt|pdf|zip)$/i,uploadMaxSize:1048576,uploadFilesLimit:5,uploadAutoStart:!0,validatorRules:[],calendars:[],calendarFirstDay:0},status:0,hidden:!0,timer:!1,validator:!1,tooltip:!1,uploader:!1,uploadQueue:0,files:[],init:function(e){var i=this;if(this.options=t.extend({},this.defaults,e),this.options.baseUrl=document.location.protocol+"//"+document.location.host+this.options.basePath+"/",this.options.ajaxUrl=this.options.baseUrl+this.options.ajaxUrl,this.options.selector=this.options.selector+this.options.id,this.options.selectorClass=this.options.selectorClass+this.options.id,this.element=t(this.options.selector),this.Msg=t(this.options.selector+"_msg"),this.Form=t(this.options.selector+"_form"),this.ButtonSend=t(this.options.selector+"_send"),this.Toggler=t(this.options.selector+"_toggler"),this.Box=t(this.options.selector+"_box"),this.Container=t(this.options.selector+"_container"),this.Token=t(this.options.selector+"_token"),this.Form.get(0)&&this.Form.get(0).reset(),o[this.options.id]={enabled:0,status:-1},0===o[this.options.id].enabled&&(o[this.options.id].enabled=this.Form.find(".pweb-captcha").length>0),this.Form.submit(function(t){t.preventDefault()}),"function"!=typeof Joomla.JText._&&(Joomla.JText.strings=Joomla.JText,Joomla.JText._=function(t,o){return"undefined"!=typeof this.strings[t.toUpperCase()]?this.strings[t.toUpperCase()]:o}),t("a[href="+this.options.selector+"_toggler]").addClass(this.options.selector.replace("#","")+"_toggler"),"slidebox"==this.options.layout)this.element.appendTo(document.body),this.options.togglerSlide=this.Box.hasClass("pweb-toggler-slide"),this.options.togglerHidden=this.Box.hasClass("pweb-toggler-hidden"),this.options.slidePos=this.element.css("position"),this.options.slideWidth||(this.options.slideWidth=parseInt(this.Box.css("max-width"))),this.Box.css("width",this.options.slideWidth),"left"==this.options.position||"right"==this.options.position?(this.Box.css(this.options.position,-this.options.slideWidth),this.options.togglerWidth=this.options.togglerSlide?this.Toggler.outerWidth():0,this.options.togglerHeight=this.options.togglerSlide?parseInt(this.Box.css("top")):0,this.options.slideOffset=parseInt(this.element.css("top")),this.options.togglerSlide&&this.Toggler.css("left"==this.options.position?"right":"left",-this.Toggler.outerWidth())):(this.Box.css(this.options.position,-this.Box.height()),this.options.togglerWidth=0,this.options.togglerHeight=this.options.togglerSlide?this.Toggler.outerHeight():0,this.options.slideOffset=0,this.options.togglerSlide&&this.Toggler.css("top"==this.options.position?"bottom":"top",-this.Toggler.outerHeight())),this.Box.addClass("pweb-closed").removeClass("pweb-init"),this.options.togglerHidden&&(this.Toggler.fadeOut(0).removeClass("pweb-closed").addClass("pweb-opened"),this.options.togglerNameClose&&this.Toggler.find(".pweb-text").text(this.options.togglerNameClose)),this.isFF=-1!=navigator.userAgent.indexOf("Gecko"),t(window).scroll(function(){if(!i.hidden&&"absolute"==i.element.css("position")&&"fixed"==i.options.slidePos){var o=t(this).scrollTop();"bottom"==i.options.position?(o+=t(this).height(),o>i.element.offset().top&&(i.isFF?i.element.css("top",o):i.element.stop().animate({top:o},250,"linear"))):(o+=i.options.slideOffset,o<i.element.offset().top&&(i.isFF?i.element.css("top",o):i.element.stop().animate({top:o},250,"linear")))}});else if("modal"==this.options.layout){if(this.element.appendTo(document.body),!this.initModal())return!1}else"accordion"==this.options.layout&&this.initAccordion();this.options.onLoad.apply(this);var s=!1;if(-1!==document.location.hash.indexOf(this.options.selector+":")){var n=document.location.hash.replace(this.options.selector+":","");0!==n.indexOf("open")||"undefined"!=typeof n[4]&&":"!=n[4]||(n=n.replace(/open(:)?/i,""),s=!0),n&&this.preloadFields(n)}if(this.options.tooltips&&this.initTooltips(),this.Form.find(".pweb-uploader").length&&this.initUploader(),this.initTextareaCounters(),this.initChosen(),this.initCalendar(),this.initHiddenFields(),this.initValidator(),this.Box.hasClass("pweb-labels-over")&&this.initLabelsOverFields(),this.options.rulesModal&&this.initModalRules(),this.ButtonSend.click(function(){i.submitForm()}),3==this.options.reset&&(this.ButtonReset=t(this.options.selector+"_reset"),this.ButtonReset.click(function(){t(this).hide(),i.resetForm()})),"static"!=this.options.layout)if(this.options.togglerNameClose&&(this.options.togglerNameOpen=this.Toggler.find(".pweb-text").text()),t(this.options.selectorClass+"_toggler").click(function(t){t.preventDefault(),i.toggleForm(-1,-1,this,t)}),this.options.closeOther&&pwebBoxes.push(this),s)this.autoPopupOnPageLoad();else if(this.options.openAuto)switch(this.options.maxAutoOpen>0&&(this.initAutoPopupCookie()||(this.options.openAuto=!1)),this.options.openAuto){case 1:this.autoPopupOnPageLoad();break;case 2:this.autoPopupOnPageScroll();break;case 3:this.autoPopupOnPageExit()}return"undefined"!=typeof navigator.cookieEnabled&&navigator.cookieEnabled===!1?this.displayMsg(Joomla.JText._("MOD_PWEBCONTACT_COOKIES_ERR"),"error"):this.displayMsg("",""),this},initModal:function(){var o=this;return"function"==typeof t.fn.modal?(this.Modal=t(this.options.selector+"_modal"),this.options.modalClass="pwebcontact"+this.options.id+"_modal-open pweb-modal-open pweb-modal-"+this.options.modalStyle,this.Modal.appendTo(document.body).modal({show:!1,keyboard:!1,backdrop:!this.options.modalClose&&this.options.modalBackdrop?"static":this.options.modalBackdrop}).on(2===this.options.bootstrap?"hidden":"hidden.bs.modal",function(e){e.stopPropagation(),e.target===e.currentTarget&&(o.toggleForm(0),t(document.body).removeClass(o.options.modalClass),o.Box.addClass("pweb-closed"))}).on(2===this.options.bootstrap?"show":"show.bs.modal",function(e){e.stopPropagation(),e.target===e.currentTarget&&(t(document.body).addClass(o.options.modalClass),o.Box.removeClass("pweb-closed"))}).click(function(t){t.target===t.currentTarget&&o.options.modalClose&&o.toggleForm(0)}),"default"!==this.options.modalEffect&&this.initGenie(),!0):(this.options.debug&&this.debug("Bootstrap Modal Plugin is not loaded"),!1)},initModalRules:function(){var o=this,e=this.Form.find(".pweb-modal-url");if(e.length)return"function"==typeof t.fn.modal?("undefined"==typeof this.options.modalClass&&(this.options.modalClass="pwebcontact"+this.options.id+"_modal-open pweb-modal-open pweb-modal-"+this.options.modalStyle),e.click(function(e){e.preventDefault();var i=t(this).attr("href");if(0!==i.indexOf("#")||0!==t(i).length){var s=t('<div class="pweb-modal pweb-modal-rules modal fade'+(2==o.options.bootstrap?" hide":"")+(o.Box.hasClass("pweb-rtl")?" pweb-rtl":"")+'"><button type="button" class="pweb-button-close" data-dismiss="modal" aria-hidden="true">&times;</button><div class="modal-body pweb-progress"></div></div>').appendTo(document.body).modal({show:!1,backdrop:"modal"==o.options.layout?0:!0}).on(2===o.options.bootstrap?"hidden":"hidden.bs.modal",function(){e.stopPropagation(),0===i.indexOf("#")&&t(i).append(n),t(document.body).removeClass(o.options.modalClass),t(this).remove()});if(t("body").on(2===o.options.bootstrap?"show":"show.bs.modal","div.pweb-modal-rules",function(e){e.stopPropagation(),e.target===e.currentTarget&&t(document.body).addClass(o.options.modalClass)}),0!==i.indexOf("#"))s.on(2===o.options.bootstrap?"shown":"shown.bs.modal",function(){t(this).find("iframe").height(t(this).height())}).find(".modal-body").html('<iframe width="100%" height="100%" frameborder="0" scrolling="yes" allowtransparency="true" src="'+i+'"></iframe>').css({width:"auto",height:"100%",padding:"0",overflow:"hidden"}).find("iframe").on("load",function(){t(this).parent().removeClass("pweb-progress")});else{var n=t(i).children();s.find(".modal-body").append(n).removeClass("pweb-progress")}s.modal("show")}}),!0):(this.options.debug&&this.debug("Bootstrap Modal Plugin is not loaded"),!1)},initGenie:function(){var o=this,e=this.Box.attr("class").match(/pweb-bg-[a-z]+/i);this.options.modalGenieClass="pweb-genie pweb-"+this.options.modalEffect+"-"+("static"!==this.options.position?this.options.position:"bottom")+" pwebcontact"+this.options.id+"-genie"+(this.Box.hasClass("pweb-radius")?" pweb-radius":"")+(this.Box.hasClass("pweb-shadow")?" pweb-shadow":"")+(e?" "+e[0]:""),"smooth"===this.options.modalEffect?(this.options.modalEaseIn="easeInQuart",this.options.modalEaseOut="easeOutQuart"):"rotate"===this.options.modalEffect&&(this.options.modalEaseIn="easeInQuint",this.options.modalEaseOut="easeOutQuint"),this.Modal.on(2===this.options.bootstrap?"show":"show.bs.modal",function(e){e.stopPropagation(),e.target===e.currentTarget&&"undefined"!=typeof o.eventSource&&t(o.eventSource).length&&o.Container.css({visibility:"hidden"})}).on(2===this.options.bootstrap?"shown":"shown.bs.modal",function(e){e.stopPropagation(),e.target===e.currentTarget&&"undefined"!=typeof o.eventSource&&t(o.eventSource).length&&t(o.eventSource).trigger("modalOpen")}),t(this.options.selectorClass+"_toggler").on("modalOpen",function(){t(this).effect({effect:"transfer",to:o.Container,duration:o.options.modalEffectDuration,easing:o.options.modalEaseIn,className:"pweb-genie-show "+o.options.modalGenieClass,complete:function(){o.Container.css({visibility:"visible"})}})}),this.Container.on("modalClose",function(){t(this).css({visibility:"hidden"}).effect({effect:"transfer",to:t(o.eventSource),duration:o.options.modalEffectDuration,easing:o.options.modalEaseOut,className:"pweb-genie-hide "+o.options.modalGenieClass,complete:function(){o.Modal.modal("hide")}})})},initAccordion:function(){var o=this;t(this.options.selectorClass+"_toggler").on("openAccordion",function(){o.Box.removeClass("pweb-closed").slideDown({duration:o.options.accordionDuration,easing:o.options.accordionEaseOut,complete:function(){var e=t(window).height(),i=o.element.outerHeight(),s=o.element.offset().top;s+i>t(window).scrollTop()+e&&(e>i&&(s=s+i-e),t("html,body").animate({scrollTop:parseInt(s)},500))}})}),t(this.options.selectorClass+"_toggler").on("closeAccordion",function(){o.Box.slideUp({duration:o.options.accordionDuration,easing:o.options.accordionEaseIn,complete:function(){o.Box.addClass("pweb-closed")}})}),this.Box.css("display","none").removeClass("pweb-init")},initTooltips:function(){var o=this;return"function"==typeof t.fn.tooltip?(this.tooltip=!0,this.Form.find("input.pweb-input.pweb-tooltip,select.pweb-tooltip,textarea.pweb-tooltip").tooltip({trigger:2==this.options.tooltips?"manual":"focus",html:!1}),this.Form.find("fieldset.pweb-tooltip,.pweb-field-checkbox label.pweb-tooltip,.fileinput-button.pweb-tooltip").tooltip({trigger:2==this.options.tooltips?"manual":"hover",html:!1}),this.Form.find(".pweb-tooltip").on("show",function(t){t.stopPropagation(),t.target!==t.currentTarget}).on("shown",function(t){t.stopPropagation(),t.target!==t.currentTarget}).on(2===this.options.bootstrap?"hide":"hide.bs.tooltip",function(e){3===o.options.bootstrap&&(e.preventDefault(),t(this).siblings("div.tooltip.in").removeClass("in")),e.stopPropagation(),e.target!==e.currentTarget}).on("hidden",function(t){t.stopPropagation(),t.target!==t.currentTarget}),!0):(this.options.debug&&this.debug("Bootstrap Tooltip Plugin is not loaded"),!1)},initCalendar:function(){if("undefined"==typeof Calendar)return!1;if(this.options.calendars.length){var o=this;t.each(this.options.calendars,function(t,e){var i="pwebcontact"+o.options.id+"_field-"+e.id;Calendar.setup({inputField:i,button:i+"_btn",onUpdate:function(){this.inputField.focus()},ifFormat:"undefined"!=typeof e.format?e.format:null,firstDay:o.options.calendarFirstDay,electric:!1})}),this.Form.find(".pweb-calendar-btn").click(function(){("fixed"==o.element.css("position")||"modal"==o.options.layout)&&t("div.calendar:last").css("position","fixed"),t(this).prev().focus()})}return!0},initChosen:function(){},initLabelsOverFields:function(){return this.Form.find("input.pweb-input,textarea").focus(function(){t("#"+t(this).attr("id")+"-lbl").parent().hide()}).blur(function(){this.value||t("#"+t(this).attr("id")+"-lbl").parent().show()}).each(function(){var o=t("#"+t(this).attr("id")+"-lbl").parent();o.parent().addClass("pweb-label-over"),this.value&&o.hide()}),this.Form.find("select").focus(function(){t("#"+t(this).attr("id")+"-lbl").parent().hide(),t(this).removeClass("pweb-blank").children(":first").text(t(this).data("default-option"))}).blur(function(){(""==t(this).val()||null==t(this).val())&&(t(this).addClass("pweb-blank").children(":first").text(" "),t("#"+t(this).attr("id")+"-lbl").parent().show())}).each(function(){var o=t("#"+t(this).attr("id")+"-lbl").parent(),e=t(this).children(":first");o.parent().addClass("pweb-label-over"),t(this).data("default-option",e.text()),""==t(this).val()||null==t(this).val()?(t(this).addClass("pweb-blank"),e.text(" ")):o.hide()}),!0},initTextareaCounters:function(){return this.Form.find("textarea[maxlength]").keyup(function(){var o=parseInt(t(this).attr("maxlength")),e=t(this).val();e.length>=o&&(e=e.substring(0,o),t(this).val(e)),t("#"+t(this).attr("id")+"-limit").text(o-e.length)}).trigger("keyup"),!0},initHiddenFields:function(){return t("<input/>",{type:"hidden",name:"title",value:document.title}).appendTo(this.Form),t("<input/>",{type:"hidden",name:"url",value:document.location.href}).appendTo(this.Form),t("<input/>",{type:"hidden",name:"screen_resolution",value:screen.width+"x"+screen.height}).appendTo(this.Form),this.options.debug&&t("<input/>",{type:"hidden",name:"debug",value:1}).appendTo(this.Form),!0},initUploader:function(){var o=this;return"function"!=typeof t.fn.fileupload?(this.options.debug&&this.debug("jQuery File Upload Plugin is not loaded"),!1):(this.uploader=t(this.options.selector+"_uploader_container").fileupload({url:this.options.ajaxUrl+"uploader",type:"POST",dataType:"json",dataFilter:this.ajaxResponseDataFilter,accepts:"application/json; charset=utf-8",headers:{Accept:"application/json; charset=utf-8"},converters:{"text json":function(o){return o=t.parseJSON(o),"undefined"!=typeof o.data&&o.data&&(o=o.data),o},"iframe json":function(o){return o=t.parseJSON(o),"undefined"!=typeof o.data&&o.data&&(o=o.data),o}},formData:function(e){return t.merge(e.serializeArray(),[{name:"format",value:"json"},{name:"mid",value:o.options.id},{name:"ignoreMessages",value:!0}])},autoUpload:this.options.uploadAutoStart===!0,acceptFileTypes:this.options.uploadAcceptFileTypes,maxFileSize:this.options.uploadMaxSize,maxNumberOfFiles:this.options.uploadFilesLimit,getNumberOfFiles:function(){return this.filesContainer.children(".pweb-upload-success, .pweb-upload-ready").length},messages:{uploadedBytes:Joomla.JText._("MOD_PWEBCONTACT_UPLOAD_BYTES_ERR"),maxNumberOfFiles:Joomla.JText._("MOD_PWEBCONTACT_UPLOAD_LIMIT_ERR"),acceptFileTypes:Joomla.JText._("MOD_PWEBCONTACT_UPLOAD_TYPE_ERR"),maxFileSize:Joomla.JText._("MOD_PWEBCONTACT_UPLOAD_SIZE_ERR")},dropZone:this.Box,pasteZone:null,uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:function(e){var i=t();return t.each(e.files,function(t,e){var s=o.uploader.find(".templates .template-upload").clone();s.find(".name").text(e.name),s.find(".cancel").bind("click",function(){s.hasClass("pweb-upload-ready")&&o.uploadQueue--,0==o.status&&o.displayMsg("","")}),i=i.add(s)}),i},downloadTemplate:function(e){var i=t();return t.each(e.files,function(s,n){var a=o.uploader.find(".templates .template-download").clone();a.find(".size").text(e.formatFileSize(n.size)),a.find(".name").text(n.name);var l=a.find(".delete").bind("click",function(){var e=t.inArray(n.name,o.files);e>-1&&o.files.splice(e,1),0==o.status&&o.displayMsg("","")});if(n.name){var p={file:n.name,mid:o.options.id,format:"json",ignoreMessages:!0};"POST"==n.deleteType&&(p._method="DELETE",l.data("type","POST")),p[o.Token.attr("name")]=1,l.data("url",o.options.ajaxUrl+"uploader&"+decodeURIComponent(t.param(p)))}n.error?(a.find(".success").remove(),a.find(".error").text(n.error)):(a.find(".warning, .error").remove(),a.addClass("pweb-upload-success"),o.files.push(n.name)),i=i.add(a)}),i}}).on("fileuploaddragover",function(){o.Box.addClass("pweb-dragged"),o.Box.find(".pweb-dropzone").css({width:o.Box.width(),height:o.Box.height()})}).on("fileuploaddrop",function(){o.Box.removeClass("pweb-dragged")}).on("fileuploadadd",function(){o.options.reloadToken&&0==o.status&&o.options.uploadAutoStart&&o.ajaxCall("getToken",!1)}).on("fileuploadprocessdone",function(t,e){o.uploadQueue++,e.context.addClass("pweb-upload-ready").find(".warning,.error").remove()}).on("fileuploadprocessfail",function(o,e){e.context.each(function(){t(this).find(".ready,.progress").remove();var o=t(this).find(".cancel");setTimeout(function(){o.click()},3e3)})}).on("fileuploadstart",function(){o.options.uploadAutoStart&&(0==o.status&&o.displayMsg("",""),o.status=2)}).on("fileuploaddone",function(t,e){o.uploadQueue--,e.getFilesFromResponse(e).length||(o.displayMsg(Joomla.JText._("MOD_PWEBCONTACT_UPLOAD_ERR")+("undefined"!=typeof e.result.message?". "+e.result.message:""),"error"),e.autoUpload===!1&&(o.status=5))}).on("fileuploadfail",function(t,e){o.displayMsg(Joomla.JText._("MOD_PWEBCONTACT_UPLOAD_ERR"),"error"),e.autoUpload===!1&&(o.status=5)}).on("fileuploadalways",function(t,e){"parsererror"==e.textStatus?o.debug(e.jqXHR.responseText):o.options.debug&&e.result&&"undefined"!=typeof e.result.debug&&e.result.debug&&o.debug(e.result.debug,e.result.status)}).on("fileuploadfinished",function(t,e){0==o.uploadQueue&&(e.autoUpload||5==o.status?o.status=0:1==o.status&&o.ajaxCall("sendEmail"))}),this.Box.bind("dragleave",function(){t(this).removeClass("pweb-dragged")}),this.tooltip&&this.uploader.find(".fileinput-button").click(function(){t(this).hasClass("pweb-tooltip")&&t(this).tooltip("hide")}),t(window).on("unload",function(){o.files.length&&o.uploader.find(".files .delete").click()}),!0)},initValidator:function(){var e=this;return"function"==typeof t.fn.validate?(o[this.options.id].enabled===!0&&setTimeout(function(){e.Form.find(".pweb-captcha input[type=text]").addClass("pweb-input required")},1e3),t.each(this.options.validatorRules,function(o,i){t.validator.addMethod("pweb"+e.options.id+"-validate-"+i.name,function(t,o){return this.optional(o)||i.regexp.test(t)},"")}),this.uploader&&t.validator.addMethod("pweb-validate-uploader",function(){return e.Container.find(".files .pweb-upload-success,.files .pweb-upload-ready").length},""),this.validator=this.Form.validate({debug:this.options.debug,onsubmit:!1,errorClass:"invalid",showErrors:function(o,i){var s,n;for(s=0;i[s];s++){var a=i[s].element;if(this.settings.highlight.call(this,a,this.settings.errorClass,this.settings.validClass),a=t(a),a.hasClass("pweb-fieldset")&&(a=a.parents("fieldset")),t("#"+a[0].id+"-lbl").addClass(this.settings.errorClass),0==s&&"fixed"!=e.element.css("position"))if("modal"==e.options.layout){var l=e.Box.outerHeight()-t(window).height();if(l>0){var p=a.parent().parent().offset().top-e.Box.offset().top;p>l&&(p=l),e.Modal.animate({scrollTop:parseInt(p)},500)}}else if("fixed"!=e.element.css("position")){var p=a.parent().parent().offset().top-10,r=t(window).scrollTop(),d=t(window).height();(r+50>p||p>r+d-50)&&(p-=d/2,t("html,body").animate({scrollTop:parseInt(p)},500))}e.tooltip&&e.options.tooltips>=2&&(a.hasClass("pweb-single-checkbox")?a.next().hasClass("pweb-tooltip")&&a.next().tooltip("show"):a.hasClass("pweb-tooltip")&&a.tooltip("show"))}for(s=0,n=this.validElements();n[s];s++){var a=n[s];this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass),a=t(a),a.hasClass("pweb-fieldset")&&(a=a.parents("fieldset")),t("#"+a[0].id+"-lbl").removeClass(this.settings.errorClass),e.tooltip&&e.options.tooltips>=2&&(a.hasClass("pweb-single-checkbox")?a.next().hasClass("pweb-tooltip")&&a.next().tooltip("hide"):a.hasClass("pweb-tooltip")&&a.tooltip("hide"))}}}),!0):(this.options.debug&&this.debug("jQuery Validate Plugin is not loaded"),!1)},preloadFields:function(o){var e=this;try{var i=o.split("/");t.each(i,function(o,i){if(i=i.split("="),i.length>=2){i[1]=unescape(i[1]);var s=t(e.options.selector+"_field-"+i[0]),n=s.prop("tagName").toLowerCase();"fieldset"==n?s.find("input").val(i[1].split(";")):"select"==n&&s.attr("multiple")?s.val(i[1].split(";")).trigger("focus").trigger("blur"):"input"==n&&"checkbox"==s.attr("type")?s.attr("checked",0!=i[1]?!0:!1):(s.val(i[1]).trigger("focus").trigger("blur"),"textarea"==n&&s.trigger("keyup"))}})}catch(s){console.log(s)}},close:function(){this.toggleForm(0)},toggleForm:function(o,e,i){var s=this;if("undefined"==typeof o&&(o=-1),"undefined"==typeof i&&(i=this.Toggler),this.hidden||-1!==o&&0!==o){if(this.hidden&&(-1===o||1===o)){if(this.options.closeOther&&t.each(pwebBoxes,function(){this.options.id!=s.options.id&&"function"==typeof this.close&&this.close()}),(1===this.options.openAuto||2===this.options.openAuto)&&(this.options.openAuto=!1,this.timer&&clearTimeout(this.timer)),"number"==typeof e&&e>=0){var n=t(this.options.selector+"_mailto");n.length&&(n[0].selectedIndex=parseInt(e),this.Box.hasClass("pweb-labels-over")&&n.trigger("focus").trigger("blur"))}if(t(i).length&&(t(i).data("pwebcontact-fields")&&this.preloadFields(t(i).data("pwebcontact-fields")),t(i).data("pwebcontact-fields-once")&&(this.preloadFields(t(i).data("pwebcontact-fields-once")),t(i).data("pwebcontact-fields-once",""))),this.hidden=!1,this.Toggler.length&&!this.options.togglerHidden&&(this.Toggler.removeClass("pweb-closed").addClass("pweb-opened"),this.options.togglerNameClose&&this.Toggler.find(".pweb-text").text(this.options.togglerNameClose)),"slidebox"==this.options.layout){var a={width:this.options.slideWidth};a[this.options.position]=0;var l=t(window).width();if("left"==this.options.position||"right"==this.options.position)this.options.slideWidth+this.options.togglerWidth>l&&(a.width=l-this.options.togglerWidth);else{var p=this.element.offset().left;"right"==this.options.offsetPosition&&(p=t(document).width()-p),this.options.slideWidth+p>l&&(a.width=l-p)}this.Box.stop(!0,!1).animate(a,this.options.slideDuration,this.options.slideTransition,function(){if("fixed"==s.options.slidePos){var o={position:"absolute"};"left"==s.options.position||"right"==s.options.position?(o.top=s.element.offset().top,s.Box.height()+s.options.togglerHeight+o.top-t(window).scrollTop()>t(window).height()&&(o.top=s.element.offset().top,s.element.css(o))):s.Box.height()+s.options.togglerHeight>t(window).height()&&(o.top=s.element.offset().top,"bottom"==s.options.position&&(o.bottom="auto"),s.element.css(o))}}).css("overflow","visible").removeClass("pweb-closed"),this.options.togglerHidden&&this.Toggler.fadeIn(this.options.slideDuration)}else"modal"==this.options.layout?("default"!=this.options.modalEffect&&t(i).length&&(this.eventSource=i),this.Modal.modal("show")):"accordion"==this.options.layout&&t(i).trigger("openAccordion");this.options.onOpen.apply(this)}}else{if(this.hidden=!0,this.Toggler.length&&!this.options.togglerHidden&&(this.Toggler.removeClass("pweb-opened").addClass("pweb-closed"),this.options.togglerNameClose&&this.Toggler.find(".pweb-text").text(this.options.togglerNameOpen)),this.options.openAuto===!1&&this.timer&&clearTimeout(this.timer),"slidebox"==this.options.layout){var a={};a[this.options.position]="left"==this.options.position||"right"==this.options.position?-this.Box.width():-this.Box.height(),this.Box.stop(!0,!1).animate(a,this.options.slideDuration,this.options.slideTransition,function(){if(s.Box.addClass("pweb-closed"),"absolute"==s.element.css("position")&&"fixed"==s.options.slidePos){var t={position:"fixed"};"left"==s.options.position||"right"==s.options.position?t.top=s.options.slideOffset:(t[s.options.position]=0,"bottom"==s.options.position&&(t.top="auto")),s.element.css(t)}}),this.options.togglerHidden&&this.Toggler.fadeOut(this.options.slideDuration)}else"modal"==this.options.layout?"default"!=this.options.modalEffect&&"undefined"!=typeof this.eventSource?this.Container.trigger("modalClose"):this.Modal.modal("hide"):"accordion"==this.options.layout&&t(i).trigger("closeAccordion");this.options.onClose.apply(this),2==this.options.reset&&this.resetForm()}},resetForm:function(){if(3==this.status){var e=this;if(setTimeout(function(){e.status=0},5e3),this.status=4,o[this.options.id].status=-1,this.displayMsg("",""),this.options.redirectURL||this.ajaxCall("getToken"),this.ButtonSend.show(),this.Form.find("textarea.pweb-charslimit").each(function(){t("#"+t(this).attr("id")+"-charsleft").text(parseInt(t(this).attr("maxlength")))}),this.validator&&this.validator.resetForm(),this.Form.get(0)&&this.Form.get(0).reset(),this.Box.hasClass("pweb-labels-over")&&this.Form.find("input.pweb-input,textarea,select").trigger("focus").trigger("blur"),this.uploader){var i=this.uploader.find(".files");i.find(".cancel,.delete").click(),i.empty(),this.files=[],this.uploadQueue=0}o[this.options.id].enabled!==!0||"undefined"==typeof Recaptcha||this.options.redirectURL||Recaptcha.reload()}},submitForm:function(){if(1==this.status||2==this.status||3==this.status||5==this.status)return!1;if(this.validator&&!this.validator.form())return!1;if(4==this.status){var e=Joomla.JText._("MOD_PWEBCONTACT_SEND_ERR");return"popup"==this.options.msgPosition?this.displayAlert(e,"error"):(this.scrollToMsg(),this.displayMsg(e,"error")),!1}if(this.status=1,this.scrollToMsg(),this.options.reloadToken&&this.ajaxCall("getToken",!1),o[this.options.id].enabled===!0&&-1===o[this.options.id].status&&this.ajaxCall("checkCaptcha",!1),o[this.options.id].status===!1)return"undefined"!=typeof Recaptcha&&Recaptcha.reload(),o[this.options.id].status=-1,!1;if(this.uploader&&!this.options.uploadAutoStart){var i=this.uploader.find(".files .pweb-upload-ready");if(i.length)return this.displayMsg(Joomla.JText._("MOD_PWEBCONTACT_UPLOADING"),"progress"),i.each(function(){var o=t(this).data("data");"function"==typeof o.submit&&o.submit()}),!0}1==this.status&&this.ajaxCall("sendEmail")},ajaxCall:function(e,i){var s=this,n={mid:this.options.id,format:"json",ignoreMessages:!0};("sendEmail"==e||"checkCaptcha"==e)&&(this.uploader&&this.files.length&&"sendEmail"==e&&(n.attachments=this.files),n=decodeURIComponent(t.param(n))+"&"+this.Form.serialize()),"undefined"==typeof i&&(i=!0),t.ajax({url:this.options.ajaxUrl+e,type:"POST",cache:!1,async:i,data:n,dataType:"json",dataFilter:this.ajaxResponseDataFilter,beforeSend:function(){"sendEmail"!=e&&i||s.displayMsg(Joomla.JText._("MOD_PWEBCONTACT_SENDING"),"progress")}}).done(function(n,a,l){if("undefined"!=typeof n.data&&"undefined"!=typeof n.data.status){var p=n.data;i||s.displayMsg("",""),"getToken"==e?(s.options.reloadToken=!1,s.Token.attr("name",p.token)):(p.debug&&s.debug(p.debug,p.status),"undefined"!=typeof p.deleted&&!s.options.reset&&p.deleted&&s.uploader&&(s.uploader.find(".files").empty(),s.files=[],s.uploadQueue=0),p.status>=1&&p.status<=199?"sendEmail"==e?(s.status=3,s.options.onComplete.apply(s,[p]),s.uploader&&s.uploader.find(".files .pweb-upload-success .delete").remove(),1==s.options.reset?s.resetForm():2==s.options.reset?s.ButtonSend.hide():3==s.options.reset?(s.ButtonSend.hide(),s.ButtonReset.show()):(s.status=4,setTimeout(function(){s.status=0},5e3)),"popup"==s.options.msgPosition&&(s.displayAlert(p.msg,"success"),p.msg=""),s.displayMsg(p.msg,"success"),s.options.closeAuto&&s.autoCloseOnSuccess(),s.options.redirectURL&&s.redirectOnSuccess()):"checkCaptcha"==e&&(o[s.options.id].status=!0):("checkCaptcha"==e&&(o[s.options.id].status=!1,s.Form.find(".pweb-captcha input").removeClass("valid").addClass("invalid")),"undefined"!=typeof p.invalid&&(s.Form.find(".invalid").removeClass("invalid"),t.each(p.invalid,function(o,e){var i=t(s.options.selector+"_"+e);i.is("input,textarea,select")&&i.addClass("invalid"),t(s.options.selector+"_"+e+"-lbl").addClass("invalid")})),s.options.onError.apply(s,[p]),s.status=0,p.status>=300&&!s.options.debug&&(s.status=5,s.ButtonSend.hide()),"popup"==s.options.msgPosition&&(s.displayAlert(p.msg,"error"),p.msg=""),s.displayMsg(p.msg,"error")))}else s.displayError(a,-1===l.responseText.indexOf("<html")?l.responseText:"")}).fail(function(t,o,e){s.displayError(t.status+" "+e,-1===t.responseText.indexOf("<html")?t.responseText:"")})},ajaxResponseDataFilter:function(o,e){if("iframe json"===e&&o&&"object"==typeof o&&(o=t(o[0].body).text()),-1!==e.indexOf("json")&&"string"==typeof o&&(0!==o.indexOf("{")||"}"!==o[o.length-1])){var i=o.match(/{"success":.+{"status":[0-9]+(,"[a-z]+":.+)+}}/i);if(i)if("function"==typeof JSON.stringify){var s=t.parseJSON(i[0]);"undefined"!=typeof s.data.debug&&s.data.debug||(s.data.debug=[]),s.data.debug.push(o.replace(i[0]," ")),o=JSON.stringify(s)}else o=i[0]}return o},scrollToMsg:function(){if(this.options.msgScroll&&("before"==this.options.msgPosition||"after"==this.options.msgPosition))if("modal"==this.options.layout){var o="after"==this.options.msgPosition?this.Box.outerHeight()-t(window).height():0;o>=0&&this.Modal.animate({scrollTop:o},500)}else if("fixed"!=this.element.css("position")){var e=this.Msg.offset().top,i=this.Msg.height(),s=t(window).scrollTop(),n=t(window).height();if(s>e||e+i>s+n){if("before"==this.options.msgPosition)var o=e-100;else var o=e+i+100-n;t("html,body").animate({scrollTop:parseInt(o)},500)}}},initAutoPopupCookie:function(){if("function"==typeof t.cookie){var o=parseInt(t.cookie("pwebcontact"+this.options.id+"_openauto"));if(o=isNaN(o)?1:o+1,o<=this.options.maxAutoOpen)return t.cookie("pwebcontact"+this.options.id+"_openauto",o,{domain:this.options.cookieDomain,path:this.options.cookiePath,expires:this.options.cookieLifetime}),!0}else this.options.debug&&this.debug("jQuery Cookie Plugin is not loaded");return!1},autoPopupOnPageLoad:function(){this.options.openDelay?this.timer=this.delay(this.toggleForm,this.options.openDelay,this,[1]):this.toggleForm(1)},autoPopupOnPageScroll:function(){var o=this;this.autoOpen=!0,t(window).scroll(function(){o.autoOpen&&(o.autoOpen=!1,o.options.openDelay?o.timer=o.delay(o.toggleForm,o.options.openDelay,o,[1]):o.toggleForm(1))})},autoPopupOnPageExit:function(){var o=this;this.autoOpen=-1,t(window).mousemove(function(t){-1==o.autoOpen&&t.clientY>70?o.autoOpen=1:1==o.autoOpen&&t.clientY<30&&(o.autoOpen=0,o.options.openDelay?o.timer=o.delay(o.toggleForm,o.options.openDelay,o,[1]):o.toggleForm(1))})},autoCloseOnSuccess:function(){this.options.closeDelay?this.timer=this.delay(this.toggleForm,this.options.closeDelay,this,[0]):this.toggleForm(0)},redirectOnSuccess:function(){var t=this;setTimeout(function(){document.location=t.options.redirectURL},1e3*this.options.redirectDelay)},delay:function(t,o,e,i){return setTimeout(function(){return t.apply(e,i||arguments)},o)},displayError:function(t,o){this.options.debug?this.status=0:(this.status=5,this.ButtonSend.hide());var e=Joomla.JText._("MOD_PWEBCONTACT_REQUEST_ERR")+t;"popup"==this.options.msgPosition?this.displayAlert(e,"error"):this.displayMsg(e,"error"),o&&this.debug(o)
},displayMsg:function(t,o){this.Msg.html(t?t:"&nbsp;").attr("class",o?"pweb-"+o:"")},displayAlert:function(o,e,i,s){if("function"==typeof t.fn.alert){var n=t('<div class="pweb-alert alert alert-block '+(e?"alert-"+e:"")+' fade in"><button data-dismiss="alert" class="close" type="button">&times;</button>'+("undefined"!=typeof i?'<h4 class="alert-heading">'+i+"</h4>":"")+"<p>"+o+"</p></div>").alert().appendTo(document.body);("undefined"==typeof s||s)&&this.options.msgCloseDelay&&setTimeout(function(){n.alert("close")},1e3*this.options.msgCloseDelay)}else n(o.replace("<br>","\r\n"))},debug:function(o,e){t.isArray(o)&&(o=o.join("<br>")),"undefined"!=typeof e&&(o=o+"<br>Response code: "+e),this.displayAlert(o,"info","Perfect Ajax Popup Contact Form Debug",!1)}}}(),pwebContact.options=pwebContact.prototype.options}(window.jQuery);